kaggle_dark_worlds
==================

Solutions from the [Kaggle Dark Worlds Competition](https://www.kaggle.com/c/DarkWorlds)

[click here to view the ipython notebook in your browser](http://nbviewer.ipython.org/url/raw.github.com/vgoklani/kaggle_dark_worlds/master/DarkWorlds.ipynb)

I found a lot of inspiration from Iain Murray's [2009 MLSS MCMC Practical](http://homepages.inf.ed.ac.uk/imurray2/teaching/09mlss/)

# Kaggle Dark Worlds

## Introduction
Kaggle launched a new competition, “Observing Dark Worlds”, where the goal was to locate Dark Matter halos in a given sky.

A Dark Matter Halo is a hypothetical component of a galaxy that envelops the galactic disk and extends well beyond the edge of the visible galaxy. The halos themselves cannot be observed directly, but their existence can be *inferred* by studying their effects on the motions of nearby galaxies.

Locating Dark Matter halos is an important problem in modern day cosmology. The gravitational field generated by a dark matter halo affects the orientations of nearby galaxies. By observing these perturbed galaxy properties, one can infer potential halo locations.

The goal of the competition was to identify the locations of dark matter halos, given both the positions and ellipticities of a set of galaxies in a simulated sky. If a halo was present in the sky, all the neighboring galaxies would be shifted by some *finite* amount. The competition organizers indirectly provided formulae that modeled how ellipiticities were shifted by a force.

The training set consisted of 300 simulated (synthetic-data) skies, each of which contained the positions of either one, two, or three halos. The test set consisted of 120 skies, again, with one, two, or three halos, but the halos positions were not provided. The goal of the competition was to find the positional coordinates of the dark matter halos.

## The Bayesian Approach

The dark matter halos exert a “force” on the galaxies, shifting the mean of the distribution.  Given these observed galaxy ellipiticites, the goal was to recover the model parameters (i.e. the position and mass of the dark matter halos) that generated them. 

This implies a Bayesian approach, the steps were as follows:

1. Construct a Prior Distribution over the dark matter halo parameters.
- The priors for the halo consisted of flat and broad parameterizations for the position, mass, cutoff radius, and standard deviation.
- The priors were constrained by carefully analyzing the training data.
- The unshifted ellipiticites were normally distributed with zero mean, and a standard deviation of 0.22 (measured from the data).
2. Construct a likelihood function; what are the observed ellipticities given a particular set of dark matter halo parameters.
3. Use Markov Chain Monte Carlo (MCMC) to calculate the log posterior, and therefore avoid calculating the normalization factor from Bayes rule.
- The algorithm for Markov Chain Monte Carlo:

* init()
** The starting halo was selected by choosing 5,000 randomly generated halos, and choosing the halo that maximized the likelihood function. This process speeds up MCMC convergence. 
* generate random samples (Markov Chain)
* after a sufficiently long-time (burn-in) the chain converges to the target distribution
* fixed step-size :(
* auto-correlation :(
* burn-in :(


## Results
There were three sets of predictions, (i.e. the 1-halo, 2-halo, and 3-halo cases). The bayesian model predictions for the 1-halo case were quite good, but the results for the two and three halo cases were poor. Some of the other competitors used optimizers to improve the predictions for these two cases by using the scoring metric as a cost function. This is something I need to research further.
